<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
	.graph-tooltip {
		min-width: 300px !important;
		text-align: center;

	}

	.tooltip_ddc_table td {
		border: solid 1px white;
	}

	div#emotion_barplot {
		width: 1000px;
		height: 600px;
		margin: auto;

	}

	svg {
		width: 100%;
		height: 100%;
	}

	.bar {
		fill: #80cbc4;
	}

	text {
		font-size: 12px;
		fill: #1E2126;
	}

	path {
		stroke: gray;
	}

	line {
		stroke: gray;
	}

	text.title {
		font-size: 22px;
		font-weight: 600;
	}

	text.label {
		font-size: 14px;
		font-weight: 400;
	}

	</style>
</head>
<body>
	
	<div id='emotion_barplot'>
		<svg />
	</div>
</body>
<script src="https://d3js.org/d3.v5.min.js"></script>
<script>
    // Laenge des Textes -> maximaler Wert auf der Y-Achse 
	  const textlen = 300;
    
    const word_distribution = [
      {
        emotion: 'Ekel',
        value: 13,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Freude',
        value: 17,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Furcht',
        value: 23,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Trauer',
        value: 7,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Ueberraschung',
        value: 52,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Verachtung',
        value: 88,
        words: ["Test", "Haus"]
      },
      {
        emotion: 'Wut',
        value: 82,
        words: ["Test", "Haus"]
      }
    ];

    const svg = d3.select('svg');
    const svgContainer = d3.select('#emotion_barplot');
    
    const margin = 80;
    const width = 1000 - 2 * margin;
    const height = 600 - 2 * margin;

		// Move chart to postion of svg
    const chart = svg.append('g')
      .attr('transform', `translate(${margin}, ${margin})`); 

    //Skaliere X-Achse um moegliche Werte abzubilden(Alle Basisemotionen)
    const xScale = d3.scaleBand()
      .range([0, width])
      .domain(word_distribution.map((s) => s.emotion)) //Moegliche Werte -> Basisemotionen
      .padding(0.4) //Abstand zwischen den Bars
    
    //Skaliere Y-Achse([0, #WoerterImText])
    const yScale = d3.scaleLinear()
      .range([height, 0])
      .domain([0, textlen]);
		
    //X-Achse
    chart.append('g')
      .attr('transform', `translate(0, ${height})`)
      .call(d3.axisBottom(xScale));

		//Y-Achse
    chart.append('g')
      .call(d3.axisLeft(yScale));

    //Fuege Daten ein
    const barGroups = chart.selectAll()
      .data(word_distribution)
      .enter()
      .append('g')
		
    //Zeichne die einzelnen Säulen des Barplot
    barGroups.append('rect')
      .attr('class', 'bar')
      .attr('x', (g) => xScale(g.emotion))
      .attr('y', (g) => yScale(g.value))
      .attr('height', (g) => height - yScale(g.value))
      .attr('width', xScale.bandwidth())
      .on('click', function (actual, i) {
        //Aktion falls auf den Balken gedrueckt wird (Zugriff auf zugehoeriges Objekt mit actual):
        const words = actual.words
		    const emotion = actual.emotion
        alert(emotion)
      })

    // Y-Achse Label
    svg.append('text')
      .attr('class', 'label')
      .attr('x', -(height / 2) - margin)
      .attr('y', margin / 2)
      .attr('transform', 'rotate(-90)')
      .attr('text-anchor', 'middle')
      .text('Vorkommen von Wörtern je Basisemotion')

		// X-Achse Label
    svg.append('text')
      .attr('class', 'label')
      .attr('x', width / 2 + margin)
      .attr('y', height + margin * 1.5)
      .attr('text-anchor', 'middle')
      .text('Basisemotionen')

		// Titel
    svg.append('text')
      .attr('class', 'title')
      .attr('x', width / 2 + margin)
      .attr('y', 45)
      .attr('text-anchor', 'middle')
      .text('Verteilung der Wörter auf die Basisemotionen')

</script>
</html>
